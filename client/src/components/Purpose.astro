---
import IconButton from './IconButton.astro'

const { title, id } = Astro.props
---
<article id = `purpose-${id}` class="bg-secondary rounded-md p-4 basis-full">
  <div class = "flex items-center justify-between">
    <h3 class = "text-xl text-gray-400">{title}</h3>

    <div class = "flex items-center gap-2">
      <IconButton iconName = "lucide--edit-3" id = `purpose-edit-${id}`/>
      <IconButton iconName = "lucide--trash-2" id = `purpose-remove-${id}`/>
    </div>
  </div>

  <div>
    <span class = "text-2xl">$</span>
    <input 
      id = `purpose-input-${id}`
      disabled = "true" 
      class="text-2xl font-bold outline-none" 
      type = "text" 
      value = "4000"
    />
  </div>
</article>

<script define:vars = {{ id }}>
const btnEdit = document.querySelector(`button#icon-button-purpose-edit-${id}`)
const btnRemove = document.querySelector(`button#icon-button-purpose-remove-${id}`)
const input = document.querySelector(`input#purpose-input-${id}`)

if (btnEdit)
  btnEdit.addEventListener("click", () => {
    if(!input) return

    if(input.getAttribute("disabled"))
      input.removeAttribute("disabled")
    else input.setAttribute("disabled", "true")
  })

if (btnRemove)
  btnRemove.addEventListener("click", async () => {
    const result =  confirm(`Delete ${id} purpose`)

    if(result) {
      const parent = document.querySelector(`#purpose-${id}`)
      if (parent) parent.remove()
    }
  })

</script>
